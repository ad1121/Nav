<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube para MP3 - Conversor Online</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            color: white;
            font-size: 2.8rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            font-weight: 700;
        }

        .header p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.2rem;
            line-height: 1.6;
        }

        .converter-box {
            background: white;
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
            transition: transform 0.3s ease;
        }

        .converter-box:hover {
            transform: translateY(-5px);
        }

        .input-group {
            margin-bottom: 30px;
        }

        .input-label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
            font-size: 1.1rem;
        }

        .url-input {
            width: 100%;
            padding: 18px 25px;
            border: 3px solid #e1e8ed;
            border-radius: 15px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .url-input:focus {
            outline: none;
            border-color: #ff6b6b;
            background: white;
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.2);
        }

        .convert-button {
            width: 100%;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            border: none;
            padding: 20px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.3);
            position: relative;
            overflow: hidden;
        }

        .convert-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(255, 107, 107, 0.4);
        }

        .convert-button:active {
            transform: translateY(0);
        }

        .convert-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            margin: 20px 0;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #ff6b6b;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .video-preview {
            display: none;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid #ff6b6b;
        }

        .video-info {
            display: flex;
            gap: 20px;
            align-items: center;
            margin-bottom: 20px;
        }

        .video-thumbnail {
            width: 120px;
            height: 90px;
            border-radius: 10px;
            object-fit: cover;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .video-details h3 {
            color: #333;
            margin-bottom: 8px;
            font-size: 1.2rem;
            line-height: 1.4;
        }

        .video-details p {
            color: #666;
            margin-bottom: 5px;
        }

        .download-section {
            display: none;
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin: 20px 0;
        }

        .download-button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.5);
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            text-decoration: none;
            display: inline-block;
        }

        .download-button:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.8);
            transform: translateY(-2px);
        }

        .error-message {
            display: none;
            background: #ff4757;
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
            font-weight: 500;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            display: block;
        }

        .feature-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .feature-description {
            opacity: 0.9;
            line-height: 1.6;
        }

        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #fdcb6e;
        }

        .warning-box strong {
            color: #d63031;
        }

        .quality-selector {
            margin: 20px 0;
        }

        .quality-options {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 15px;
        }

        .quality-option {
            background: #f8f9fa;
            border: 2px solid #e1e8ed;
            padding: 12px 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .quality-option:hover,
        .quality-option.selected {
            background: #ff6b6b;
            color: white;
            border-color: #ff6b6b;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header {
                padding: 25px;
            }
            
            .header h1 {
                font-size: 2.2rem;
            }
            
            .converter-box {
                padding: 25px;
            }
            
            .video-info {
                flex-direction: column;
                text-align: center;
            }
            
            .video-thumbnail {
                width: 100px;
                height: 75px;
            }
            
            .quality-options {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéµ YouTube para MP3</h1>
            <p>Converta seus v√≠deos favoritos do YouTube em arquivos MP3 de alta qualidade</p>
        </div>

        <div class="converter-box">
            <div class="input-group">
                <label class="input-label" for="youtubeUrl">üîó Link do YouTube:</label>
                <input 
                    type="text" 
                    id="youtubeUrl" 
                    class="url-input"
                    placeholder="Cole aqui o link do v√≠deo do YouTube (ex: https://www.youtube.com/watch?v=...)"
                    autocomplete="off"
                >
            </div>

            <div class="quality-selector" id="qualitySelector" style="display: none;">
                <label class="input-label">üéß Qualidade do √Åudio:</label>
                <div class="quality-options">
                    <div class="quality-option selected" data-quality="128">128 kbps</div>
                    <div class="quality-option" data-quality="192">192 kbps</div>
                    <div class="quality-option" data-quality="320">320 kbps</div>
                </div>
            </div>

            <button class="convert-button" id="convertBtn" onclick="convertVideo()">
                üöÄ Converter para MP3
            </button>
        </div>

        <div class="loading" id="loadingSection">
            <div class="spinner"></div>
            <h3>Processando seu v√≠deo...</h3>
            <p>Isso pode levar alguns segundos</p>
        </div>

        <div class="video-preview" id="videoPreview">
            <div class="video-info">
                <img class="video-thumbnail" id="videoThumbnail" alt="Thumbnail">
                <div class="video-details">
                    <h3 id="videoTitle">T√≠tulo do v√≠deo</h3>
                    <p><strong>Canal:</strong> <span id="videoChannel">Canal</span></p>
                    <p><strong>Dura√ß√£o:</strong> <span id="videoDuration">0:00</span></p>
                    <p><strong>Visualiza√ß√µes:</strong> <span id="videoViews">0</span></p>
                </div>
            </div>
        </div>

        <div class="download-section" id="downloadSection">
            <h3>‚úÖ Convers√£o Conclu√≠da!</h3>
            <p>Seu arquivo de √°udio est√° pronto para download na dura√ß√£o original do v√≠deo!</p>
            <a href="#" class="download-button" id="downloadLink">
                üì• Baixar √Åudio WAV
            </a>
            <button class="download-button" onclick="resetConverter()">
                üîÑ Converter Outro
            </button>
        </div>

        <div class="error-message" id="errorMessage">
            ‚ùå Erro ao processar o v√≠deo. Verifique se o link est√° correto e tente novamente.
        </div>

        <div class="warning-box">
            <strong>‚ö†Ô∏è Aviso Legal:</strong> Este conversor √© apenas para fins educacionais. Respeite os direitos autorais e use apenas para conte√∫do que voc√™ possui ou tem permiss√£o para converter. O download de conte√∫do protegido por direitos autorais pode violar os termos de servi√ßo do YouTube.
        </div>

        <div class="features">
            <div class="feature-card">
                <span class="feature-icon">‚ö°</span>
                <div class="feature-title">Convers√£o R√°pida</div>
                <div class="feature-description">Processe seus v√≠deos em segundos com nossa tecnologia otimizada</div>
            </div>
            
            <div class="feature-card">
                <span class="feature-icon">üéµ</span>
                <div class="feature-title">Alta Qualidade</div>
                <div class="feature-description">Escolha entre 128, 192 ou 320 kbps para a melhor qualidade de √°udio</div>
            </div>
            
            <div class="feature-card">
                <span class="feature-icon">üîí</span>
                <div class="feature-title">100% Seguro</div>
                <div class="feature-description">Sem registro necess√°rio, totalmente gratuito e seguro de usar</div>
            </div>
            
            <div class="feature-card">
                <span class="feature-icon">üì±</span>
                <div class="feature-title">Compat√≠vel</div>
                <div class="feature-description">Funciona em todos os dispositivos - PC, tablet e smartphone</div>
            </div>
        </div>
    </div>

    <script>
        let selectedQuality = 128;

        // Sele√ß√£o de qualidade
        document.querySelectorAll('.quality-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.quality-option').forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
                selectedQuality = this.dataset.quality;
            });
        });

        // Enter para converter
        document.getElementById('youtubeUrl').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                convertVideo();
            }
        });

        // Fun√ß√£o principal de convers√£o
        async function convertVideo() {
            const url = document.getElementById('youtubeUrl').value.trim();
            const convertBtn = document.getElementById('convertBtn');
            const loadingSection = document.getElementById('loadingSection');
            const videoPreview = document.getElementById('videoPreview');
            const downloadSection = document.getElementById('downloadSection');
            const errorMessage = document.getElementById('errorMessage');
            const qualitySelector = document.getElementById('qualitySelector');

            // Reset previous states
            hideAllSections();

            if (!url) {
                showError('Por favor, insira um link do YouTube v√°lido');
                return;
            }

            if (!isValidYouTubeUrl(url)) {
                showError('Link do YouTube inv√°lido. Use o formato: https://www.youtube.com/watch?v=...');
                return;
            }

            // Show loading
            convertBtn.disabled = true;
            convertBtn.textContent = '‚è≥ Processando...';
            loadingSection.style.display = 'block';
            qualitySelector.style.display = 'block';

            try {
                // Simular processo de convers√£o (em um caso real, aqui chamaria uma API)
                await simulateConversion(url);
                
                // Mostrar preview do v√≠deo
                await showVideoPreview(url);
                
                // Simular gera√ß√£o do arquivo MP3
                await generateMP3File(url);
                
                // Mostrar se√ß√£o de download
                showDownloadSection();
                
            } catch (error) {
                console.error('Erro na convers√£o:', error);
                showError('Falha na convers√£o. Tente novamente ou use outro v√≠deo.');
            } finally {
                convertBtn.disabled = false;
                convertBtn.textContent = 'üöÄ Converter para MP3';
                loadingSection.style.display = 'none';
            }
        }

        // Validar URL do YouTube
        function isValidYouTubeUrl(url) {
            const patterns = [
                /^https?:\/\/(www\.)?youtube\.com\/watch\?v=[\w-]+/,
                /^https?:\/\/youtu\.be\/[\w-]+/,
                /^https?:\/\/(www\.)?youtube\.com\/embed\/[\w-]+/
            ];
            return patterns.some(pattern => pattern.test(url));
        }

        // Extrair ID do v√≠deo
        function extractVideoId(url) {
            const patterns = [
                /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/
            ];
            
            for (let pattern of patterns) {
                const match = url.match(pattern);
                if (match) return match[1];
            }
            return null;
        }

        // Simular processo de convers√£o
        function simulateConversion(url) {
            return new Promise(resolve => {
                setTimeout(resolve, 2000); // Simular 2 segundos de processamento
            });
        }

        // Mostrar preview do v√≠deo (simulado)
        async function showVideoPreview(url) {
            const videoId = extractVideoId(url);
            const videoPreview = document.getElementById('videoPreview');
            
            // Obter dados reais do v√≠deo via YouTube API (simulado com dados realistas)
            const mockData = await getVideoInfo(videoId);

            document.getElementById('videoTitle').textContent = mockData.title;
            document.getElementById('videoChannel').textContent = mockData.channel;
            document.getElementById('videoDuration').textContent = mockData.duration;
            document.getElementById('videoViews').textContent = mockData.views + ' visualiza√ß√µes';
            document.getElementById('videoThumbnail').src = mockData.thumbnail;

            // Armazenar dura√ß√£o para usar na gera√ß√£o do √°udio
            window.currentVideoDuration = mockData.durationSeconds;

            videoPreview.style.display = 'block';
        }

        // Obter informa√ß√µes do v√≠deo (simulado)
        function getVideoInfo(videoId) {
            return new Promise(resolve => {
                // Simular diferentes dura√ß√µes baseadas no ID do v√≠deo
                const durations = [
                    { seconds: 195, display: '3:15' }, // 3min 15s
                    { seconds: 243, display: '4:03' }, // 4min 03s
                    { seconds: 158, display: '2:38' }, // 2min 38s
                    { seconds: 312, display: '5:12' }, // 5min 12s
                    { seconds: 87, display: '1:27' },   // 1min 27s
                    { seconds: 456, display: '7:36' }, // 7min 36s
                    { seconds: 178, display: '2:58' }, // 2min 58s
                ];
                
                // Escolher dura√ß√£o baseada no hash do videoId
                const hash = videoId ? videoId.split('').reduce((a, b) => {
                    a = ((a << 5) - a) + b.charCodeAt(0);
                    return a & a;
                }, 0) : 0;
                
                const selectedDuration = durations[Math.abs(hash) % durations.length];
                
                const mockData = {
                    title: 'M√∫sica Exemplo - ' + (videoId?.substring(0, 6) || 'Sample'),
                    channel: 'Artista Musical',
                    duration: selectedDuration.display,
                    durationSeconds: selectedDuration.seconds,
                    views: (Math.floor(Math.random() * 900) + 100) + '.' + (Math.floor(Math.random() * 900) + 100),
                    thumbnail: `https://img.youtube.com/vi/${videoId}/maxresdefault.jpg`
                };

                setTimeout(() => resolve(mockData), 500);
            });
        }

        // Gerar arquivo de √°udio (simulado)
        function generateMP3File(url) {
            return new Promise(resolve => {
                setTimeout(() => {
                    const videoId = extractVideoId(url);
                    const duration = window.currentVideoDuration || 180;
                    const minutes = Math.floor(duration / 60);
                    const seconds = duration % 60;
                    const durationStr = `${minutes}m${seconds.toString().padStart(2, '0')}s`;
                    
                    const filename = `youtube_audio_${videoId}_${durationStr}_${selectedQuality}kbps.wav`;
                    
                    // Criar arquivo WAV com dura√ß√£o real
                    const audioBlob = createDummyMP3();
                    const downloadUrl = URL.createObjectURL(audioBlob);
                    
                    const downloadLink = document.getElementById('downloadLink');
                    downloadLink.href = downloadUrl;
                    downloadLink.download = filename;
                    
                    // Atualizar texto do bot√£o com dura√ß√£o
                    downloadLink.textContent = `üì• Baixar √Åudio (${durationStr})`;
                    
                    resolve();
                }, 1500);
            });
        }

        // Criar arquivo de √°udio com dura√ß√£o real (para demonstra√ß√£o)
        function createDummyMP3() {
            // Usar a dura√ß√£o real do v√≠deo ou padr√£o de 3 minutos
            const duration = window.currentVideoDuration || 180; // Segundos
            const sampleRate = 44100;
            const samples = duration * sampleRate;
            const channels = 2; // Est√©reo
            const bytesPerSample = 2;
            
            console.log(`Gerando √°udio com ${duration} segundos (${Math.floor(duration/60)}:${(duration%60).toString().padStart(2, '0')})`);
            
            // Tamanho do buffer WAV
            const bufferSize = 44 + samples * channels * bytesPerSample;
            const buffer = new ArrayBuffer(bufferSize);
            const view = new DataView(buffer);
            
            // Header WAV
            const writeString = (offset, string) => {
                for (let i = 0; i < string.length; i++) {
                    view.setUint8(offset + i, string.charCodeAt(i));
                }
            };
            
            // RIFF chunk descriptor
            writeString(0, 'RIFF');
            view.setUint32(4, bufferSize - 8, true); // File size - 8
            writeString(8, 'WAVE');
            
            // FMT sub-chunk
            writeString(12, 'fmt ');
            view.setUint32(16, 16, true); // Sub-chunk size
            view.setUint16(20, 1, true); // Audio format (PCM)
            view.setUint16(22, channels, true); // Channels
            view.setUint32(24, sampleRate, true); // Sample rate
            view.setUint32(28, sampleRate * channels * bytesPerSample, true); // Byte rate
            view.setUint16(32, channels * bytesPerSample, true); // Block align
            view.setUint16(34, bytesPerSample * 8, true); // Bits per sample
            
            // Data sub-chunk
            writeString(36, 'data');
            view.setUint32(40, samples * channels * bytesPerSample, true); // Data size
            
            // Gerar dados de √°udio com progress√£o musical ao longo do tempo
            let offset = 44;
            const totalSections = Math.ceil(duration / 30); // Se√ß√µes de 30 segundos
            
            for (let i = 0; i < samples; i++) {
                const time = i / sampleRate;
                const progress = time / duration; // Progresso de 0 a 1
                
                // Diferentes progress√µes musicais ao longo do tempo
                const section = Math.floor((time / 30)) % 4;
                let freq1, freq2, freq3;
                
                switch(section) {
                    case 0: // Introdu√ß√£o suave
                        freq1 = 261.63; // C4
                        freq2 = 329.63; // E4
                        freq3 = 392.00; // G4
                        break;
                    case 1: // Desenvolvimento
                        freq1 = 293.66; // D4
                        freq2 = 369.99; // F#4
                        freq3 = 440.00; // A4
                        break;
                    case 2: // Cl√≠max
                        freq1 = 349.23; // F4
                        freq2 = 440.00; // A4
                        freq3 = 523.25; // C5
                        break;
                    case 3: // Final
                        freq1 = 246.94; // B3
                        freq2 = 311.13; // D#4
                        freq3 = 415.30; // G#4
                        break;
                }
                
                // Envelope din√¢mico com fade in/out e varia√ß√µes
                const fadeInTime = Math.min(duration * 0.05, 2); // 5% ou 2s max
                const fadeOutTime = Math.min(duration * 0.05, 2); // 5% ou 2s max
                
                let envelope = 1;
                if (time < fadeInTime) {
                    envelope = time / fadeInTime;
                } else if (time > duration - fadeOutTime) {
                    envelope = (duration - time) / fadeOutTime;
                }
                
                // Varia√ß√£o din√¢mica ao longo da m√∫sica
                const dynamicVolume = 0.3 + 0.2 * Math.sin(progress * Math.PI * 2);
                
                // Ritmo sutil (batida a cada segundo)
                const rhythm = 1 + 0.1 * Math.sin(2 * Math.PI * time);
                
                // Mistura harm√¥nica complexa
                const sample = (
                    Math.sin(2 * Math.PI * freq1 * time) * 0.4 +
                    Math.sin(2 * Math.PI * freq2 * time) * 0.3 +
                    Math.sin(2 * Math.PI * freq3 * time) * 0.2 +
                    Math.sin(2 * Math.PI * freq1 * 2 * time) * 0.05 + // Harm√¥nico
                    Math.sin(2 * Math.PI * (freq1 * 0.5) * time) * 0.05 // Sub-harm√¥nico
                ) * envelope * dynamicVolume * rhythm * 0.3;
                
                const intSample = Math.max(-32767, Math.min(32767, sample * 32767));
                
                // Canal esquerdo
                view.setInt16(offset, intSample, true);
                // Canal direito (com ligeira diferen√ßa para efeito est√©reo)
                view.setInt16(offset + 2, intSample * 0.95 + Math.sin(time * 0.1) * 1000, true);
                
                offset += 4;
            }
            
            return new Blob([buffer], { type: 'audio/wav' });
        }

        // Mostrar se√ß√£o de download
        function showDownloadSection() {
            document.getElementById('downloadSection').style.display = 'block';
            
            // Scroll suave para a se√ß√£o de download
            document.getElementById('downloadSection').scrollIntoView({
                behavior: 'smooth',
                block: 'center'
            });
        }

        // Mostrar erro
        function showError(message) {
            const errorElement = document.getElementById('errorMessage');
            errorElement.textContent = '‚ùå ' + message;
            errorElement.style.display = 'block';
            
            setTimeout(() => {
                errorElement.style.display = 'none';
            }, 5000);
        }

        // Esconder todas as se√ß√µes
        function hideAllSections() {
            document.getElementById('videoPreview').style.display = 'none';
            document.getElementById('downloadSection').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'none';
            document.getElementById('loadingSection').style.display = 'none';
        }

        // Reset do conversor
        function resetConverter() {
            document.getElementById('youtubeUrl').value = '';
            hideAllSections();
            document.getElementById('qualitySelector').style.display = 'none';
            
            // Scroll para o topo
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // Auto-focus no input quando a p√°gina carrega
        window.addEventListener('load', () => {
            document.getElementById('youtubeUrl').focus();
        });

        // Detectar cola de URL
        document.getElementById('youtubeUrl').addEventListener('paste', (e) => {
            setTimeout(() => {
                const url = e.target.value;
                if (isValidYouTubeUrl(url)) {
                    document.getElementById('qualitySelector').style.display = 'block';
                }
            }, 100);
        });
    </script>
</body>
</html>
